모바일 게임 서버

모바일 게임의 특징
1. Online
- 네트워크가 연결되어 있어야 Login이 가능하다.
2. Offline
- 게임 도중에 네트워크가 끊어져도 진행이 가능하다.
- PvP도 자동전투가 기본
3. Online
- 한 판 진행 후 정산할 때는 네트워크가 연결되어야 한다.

모바일 게임 서버 구조
- 유저 정보는 게임 서버 Data Base에 저장
	. 핸드폰을 바꿔도 OK, 게임을 지웠다 깔아도 OK
- 게임 서버는 스테이지 사이의 정산만 함
	. 해킹에 매우 취약
	  - 모든 판단을 클라이언트에서 함
	  - 스테이지 보상은 서버에서
	. Web 서비스로 구현 가능
	  - 클라이언트는 3D 그래픽 웹브라우저
- 서버 분리 없이 통합 World
	. Database 부하가 큼 -> NoSQL 사용

구조 : 기능별로 복수의 서버가 분산 처리
- Auth Server
	. 인증 서버
- Web Server
	. 동접이 많아야 1000명
	. 이 서버 여러 대를 연결함
- L4 Switch
	. 서버에 connect 패킷이 오면 여러 대의 서버 중 어디에 연결할지
	. 서버 부하 분산을 처리하는 장비(하드웨어)이다.
- DB Server
- Match Server
- Game Server or Relay Server
- Chatting Server
- CDN Server (Content Delivery Network Server)
	. 매주 목요일 아침마다 몇십만의 플레이어가 동시에 업데이트를 한다.
	. 미리 한 시점의 서버를 빌린다.

발전 추세
- 실시간 온라인 플레이의 추가
- 실시간 PvP, 실시간 길드전, FPS, MMORPG
- MMORPG는 PC와 동일
- MMORPG 이외는 인던 형식의 플레이 (스타의 배틀넷과 비슷)
	. HotSpot이 없는 서버, 시야의 개념이 없는 서버
	. 구현 난이도가 낮음

이슈 : SPOF (Single Point of Failure)
- 많은 요소로 이루어진 시스템에서 고장이 날 경우 전체 시스템이 멈춰지는 요소

- Fail 원인 : 컴퓨터 HW 고장, SW BUG, 과부하
- 결과 : 전체 서버 Down
- MMORPG에서 문제가 되지 않았던 이유
	. Sharding
- 해결책
	. 중복 : 일부분만 Down
	. 대체 가능 : 마이그레이션, 즉시 복구

MMORPG 서버에서의 PC와의 차이
- Hand Over 기능
	. 모바일은 socket 연결이 자주 끊김
	  - 음영지역, 기지국 변환
	  - LTE <-> WIFI <-> 5G 전환
	. PC의 경우는 socket close 시 logout 시키면 되나 모바일은 문제가 됨
	. socket이 끊어진 경우 클라이언트와 서버에서 transparent하게
	  재접속을 시켜야 함.

클라우드 서버
- 서버를 실제 컴퓨터에서 실행하는 것이 아니라 가상머신 상에서 실행
- 가상머신은 여러 대의 실제 컴퓨터 중 아무데서나 실행 될 수 있음
	. 유연성
	  - 컴퓨터가 고장나면 옆 컴퓨터에서 실행
	  - 가상머신은 File (메모리, 디스크, CPU data의 묶음)
	. 확장성
	  - 가상머신을 복사해서 빈 컴퓨터에서 실행
	  - 기존의 15일에서 10분으로 단축

클라우드 서버의 장점
- 자동 관리가 쉽다
	. 설치, 확장, 이동이 자유롭다.
- 경제적이다.
	. 서버의 부하가 없을 경우 하나의 컴퓨터에서
	  여러 대의 가상머신을 실행하면 된다.
	. 부하가 없을 때 반환 가능

클라우드 서버의 단점
- 느리다
	. MMORPG에 적당하지 않다.

클라우드 서버 사용상의 주의
- 오픈 소스에 친숙해야 한다.
	. 관리 SW
- 서비스 게임이 많아지면 자체 클라우드를 운영하는 것이 저렴하다.
	. 비용 2배
- 기존 게임을 클라우드로 이전하려 할 때는 성능 측정을 미리 해보아야 한다.
	. Database 포함